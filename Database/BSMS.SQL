USE master
GO
IF EXISTS (SELECT * FROM SYSDATABASES WHERE NAME='BSMS')
	DROP DATABASE BSMS
GO
CREATE DATABASE BSMS
GO

USE BSMS
GO
CREATE TABLE [ROLE](
	ROLEID INT PRIMARY KEY IDENTITY(3,3),
	ROLE VARCHAR(10) NOT NULL
)
GO
CREATE TABLE [USER](
	USERID INT PRIMARY KEY IDENTITY (67898,90),
	USERNAME VARCHAR(14) NOT NULL,
	PASSWORDHASH VARCHAR(70) NOT NULL,
	FIRSTNAME VARCHAR(20),
	LASTNAME VARCHAR(20),
	MIDDLENAME VARCHAR(20),
	THUMBNAIL_PATH VARCHAR(70),
	EMAIL VARCHAR(20) NOT NULL,
	ROLEID INT FOREIGN KEY REFERENCES [ROLE](ROLEID)
)

GO

CREATE TABLE AUTHOR (
	AUTHORID INT PRIMARY KEY IDENTITY(8124566,789),
	FIRSTNAME VARCHAR(12),
	LASTNAME VARCHAR(12),
	MIDDLENAME VARCHAR(12),
	BIOGRAPHY VARCHAR(1000),
	ALIASNAME VARCHAR(8) UNIQUE NULL,
	THUMBNAIL_PATH VARCHAR(70)
)
GO

CREATE TABLE CATEGORY(
	CATEGORYID INT PRIMARY KEY IDENTITY(1,1),
	NAME VARCHAR(12) NOT NULL,
	DESCRIPTION VARCHAR(200),
	REFERENCE_KEY VARCHAR(20) UNIQUE NOT NULL,
	CATEGORY_THUMBNAIL VARCHAR(80)
)

GO

CREATE TABLE GENRE(
	GENREID INT PRIMARY KEY IDENTITY(1,1),
	NAME VARCHAR(12) NOT NULL,
	DESCRIPTION VARCHAR(200),
	REFERENCE_KEY VARCHAR(20) UNIQUE NOT NULL
)

GO
CREATE TABLE PRODUCER(
	PRODUCERID INT PRIMARY KEY IDENTITY(34,7),
	NAME VARCHAR(50),
	ADDRESS VARCHAR(100),
	CONTACT VARCHAR(50),
	EMAIL VARCHAR(50)
)
GO
CREATE TABLE BOOK (
	BOOKID INT PRIMARY KEY IDENTITY(233121,78),
	ISBN_NUMBER BIGINT NOT NULL,
	NAME VARCHAR(30),
	THUMBNAIL_PATH VARCHAR(70) NOT NULL,
	STATUS VARCHAR(10),
	SYNOPOSIS VARCHAR(300) NOT NULL,
	ISPUBLISHED BIT DEFAULT(0),
	REFERENCE VARCHAR(100),
	DATE_PUBLISHED DATETIME ,
	CREATED_DATE DATETIME DEFAULT(GETDATE()),
	PRICE FLOAT,
	PERCENTAGE_OFF INT,
	GENREID INT FOREIGN KEY REFERENCES GENRE(GENREID),
	STAFFID INT FOREIGN KEY REFERENCES [USER](USERID),
	PRODUCERID INT FOREIGN KEY REFERENCES PRODUCER(PRODUCERID)
)

GO


CREATE TABLE BOOK_CATEGORY(
	BOOK_CATEGORYID INT PRIMARY KEY IDENTITY(9,9),
	BOOKID INT FOREIGN KEY REFERENCES BOOK(BOOKID),
	CATEGORYID INT FOREIGN KEY REFERENCES CATEGORY(CATEGORYID)	
)
	

GO
CREATE TABLE BOOK_AUTHOR(
	BOOK_AUTHORID INT PRIMARY KEY IDENTITY(9,9),
	BOOKID INT FOREIGN KEY REFERENCES BOOK(BOOKID),
	AUTHORID INT FOREIGN KEY REFERENCES AUTHOR(AUTHORID)	
)

GO
CREATE TABLE BOOK_SOFTCOPY(
	BSCID INT PRIMARY KEY IDENTITY(12,13),
	BOOKID INT FOREIGN KEY REFERENCES BOOK(BOOKID),
	VERSION VARCHAR(10),
	FILEPATH VARCHAR(80) NOT NULL,
	FILESIZE FLOAT
)

GO


CREATE TABLE WATCHLIST(
	WATCHLISTID INT PRIMARY KEY IDENTITY(12,3),
	BOOKID INT FOREIGN KEY REFERENCES BOOK (BOOKID)
)
