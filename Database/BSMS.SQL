DROP IF EXISTS (SELECT * FROM SYSDATABASES WHERE NAME='BSMS')
GO
CREATE DATABASE BSMS
GO

USE BSMS
GO
CREATE TABLE [ROLE](
	ROLEID INT PRIMARY KEY IDENTITY(3,3),
	ROLE VARCHAR(10) NOT NULL
)
GO
CREATE TABLE [USER](
	USERID INT PRIMARY KEY IDENTITY (67898,90),
	USERNAME VARCHAR(14) NOT NULL,
	PASSWORDHASH VARCHAR(70) NOT NULL,
	FIRSTNAME VARCHAR(20),
	LASTNAME VARCHAR(20),
	MIDDLENAME VARCHAR(20),
	THUMBNAIL_PATH VARCHAR(70),
	EMAIL VARCHAR(20) NOT NULL,
	ROLEID INT FOREIGN KEY REFERENCES [ROLE](ROLEID)
)

GO

CREATE TABLE AUTHOR (
	AUTHORID INT PRIMARY KEY IDENTITY(8124566,789),
	FIRSTNAME VARCHAR(12),
	LASTNAME VARCHAR(12),
	MIDDLENAME VARCHAR(12),
	BIOGRAPHY VARCHAR(1000),
	ALIASNAME VARCHAR(8) UNIQUE NULL,
	THUMBNAIL_PATH VARCHAR(70)
)
GO

CREATE TABLE CATEGORY(
	CATEGORYID INT PRIMARY KEY IDENTITY(1,1),
	NAME VARCHAR(12) NOT NULL,
	DESCRIPTION VARCHAR(200),
	REFERENCE_KEY VARCHAR(20) UNIQUE NOT NULL,
	CATEGORY_THUMBNAIL VARCHAR(80)
)

GO

CREATE TABLE SUBCATEGORY(
	SUBCATID INT PRIMARY KEY IDENTITY(1,1),
	NAME VARCHAR(12) NOT NULL,
	DESCRIPTION VARCHAR(200),
	CATEGORYID INT FOREIGN KEY REFERENCES CATEGORY(CATEGORYID),
	REFERENCE_KEY VARCHAR(20) UNIQUE NOT NULL
)

GO

CREATE TABLE BOOK (
	BOOKID INT PRIMARY KEY IDENTITY(233121,78),
	ISBN_NUMBER BIGINT NOT NULL,
	NAME VARCHAR(30),
	THUMBNAIL_PATH VARCHAR(70) NOT NULL,
	STATUS VARCHAR(10),
	SYNOPOSIS VARCHAR(300) NOT NULL,
	PUBLISHED BIT DEFAULT(0),
	REFERENCE VARCHAR(100),
	DATE_PUBLISHED DATETIME ,
	CREATED_DATE DATETIME DEFAULT(GETDATE()),
	PRICE FLOAT,
	CATEGORYID INT FOREIGN KEY REFERENCES CATEGORY(CATEGORYID),
	GENREID INT FOREIGN KEY REFERENCES GENRE(GENREID),
	STAFFID INT FOREIGN KEY REFERENCES [USER](USERID),
	SUPPLIERID INT FOREIGN KEY REFERENCES SUPPLIER(SUPPLIERID),
	AUTHORID INT FOREIGN KEY REFERENCES AUTHOR(AUTHORID)
)

GO

CREATE TABLE BOOK_SOFTCOPY(
	BSCID INT PRIMARY KEY IDENTITY(12,13),
	BOOKID INT FOREIGN KEY REFERENCES BOOK(BOOKID),
	VERSION VARCHAR(10),
	FILEPATH VARCHAR(80) NOT NULL,
	FILEBYTE BYTES,
	FILESIZE FLOAT
)

GO


CREATE TABLE WATCHLIST(
	WATCHLISTID INT FOREIGN KEY IDENTITY(12,3),
	BOOKID INT FOREIGN KEY REFERENCES BOOK (BOOKID),
	SERIESID INT FOREIGN KEY REFERENCES SERIES(SERIESID)
)

GO

CREATE TABLE RATING(
	RATINGID INT PRIMARY KEY IDENTITY(12,12),
	USERID INT FOREIGN KEY REFERENCES [USER](USERID),
	BOOKID INT FOREIGN KEY REFERENCES BOOK (BOOKID),
	RATING INT
)

GO

CREATE TABLE REVIEW(
	REVIEWID INT PRIMARY KEY IDENTITY(12,12),
	USERID INT FOREIGN KEY REFERENCES [USER](USERID),
	BOOKID INT FOREIGN KEY REFERENCES BOOK (BOOKID),
	REVIEW_MESSAGE VARCHAR(100)
)